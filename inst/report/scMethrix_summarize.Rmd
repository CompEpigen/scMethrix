---
title: "scMethrix Summary"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
    self_contained: yes
    css: custom.css
    theme: sandstone
    highlight: tango
params:
  hasCov: FALSE
  plotDensityScore: NULL
  plotDensityCoverage: NULL
  plotCpGsCoveredCountBySample: NULL
  plotCpGsCoveredCountByChr: NULL
  plotCpGsCoveredFracBySample: NULL
  plotCpGsCoveredFracByChr: NULL
---

```{r include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r echo=FALSE}
# Input a named list of plots, and this creates a tabbed panel of the plots in plotly format
putInTabs <- function(plots) {
  for(plot in names(plots)) {
    cat("##", plot, '{-}',  '\n\n')
    print(htmltools::tagList(plotly::ggplotly(plots[[plot]])))
    cat( '\n\n')
  }
}
```

```{r, include=FALSE}
# To make sure plotly libs are initialized
htmltools::tagList(plotly::plot_ly(data = iris, x = ~Sepal.Length, y = ~Petal.Length))
```


<img src="logo_large_hexagon.gif" height="150" width="150" style="position:absolute;top:30px;right:0px;"/>

```{r}
if (!requireNamespace("ggplot2", quietly = TRUE))
    install.packages("ggplot2")
library(ggplot2)

if (!requireNamespace("plotly", quietly = TRUE))
    install.packages("plotly")
library(plotly)
```


<!-- Figure 1 -->

```{r, echo=FALSE}
plots <- list()
plots[["Score"]] <- params$plotDensityScore

if (params$hasCov) {
  plots[["Coverage"]] <- params$plotDensityCoverage
}
```

# Density {.tabset .tabset-pills}
```{r, results='asis', echo = FALSE}
putInTabs(plots)
```

<!-- Figure 2 -->

```{r, echo=FALSE}
plots <- list()
plots[["Count"]] <- params$plotCpGsCoveredCountBySample
plots[["Proportion"]] <- params$plotCpGsCoveredFracBySample
```

# Reference CpGs covered (by sample) {.tabset .tabset-pills}
# Density {.tabset .tabset-pills}
```{r, results='asis', echo = FALSE}
putInTabs(plots)
```

<!-- Figure 3 -->

```{r, echo=FALSE}
plots <- list()
plots[["Count"]] <- params$plotCpGsCoveredCountByChr
plots[["Proportion"]] <- params$plotCpGsCoveredFracByChr
```

# Reference CpGs covered (by chromosome) {.tabset .tabset-pills}
```{r, results='asis', echo = FALSE}
putInTabs(plots)
```

