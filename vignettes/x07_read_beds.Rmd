---
title: "S02: In-depth read_beds()"
author: "Andrew Lindsay, Reka Toth"
date: "`r Sys.Date()`"
output: 
  html_document:
  toc: true
toc_depth: 3
toc_float: true
self_contained: yes
highlight: pygments
vignette: >
  %\VignetteIndexEntry{S02: In-depth read_beds()}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Integration with other tools

`scMethrix` has multiple options to export data for different purposes. The `write_bedgraph` function supports a bedgraph format, that can be directly uploaded to UCSC. The `multibed` option generates a file with all samples as columns. The `metilene` option ensures that this file is in the correct format for [metilene](http://www.bioinf.uni-leipzig.de/Software/metilene/), a command line DMR caller.  

```{r eval=FALSE}
# UCSC browser
export_bedgraphs(m = meth, output_dir = ".")
# Metilene
write_bedgraphs(m = meth, output_dir = ".", rm_NA = FALSE, metilene = TRUE,multiBed = "metline_ip", phenoCol = "Day")
```

We also support bigWig format.

```{r, eval=F}
write_bigwigs(meth, output_dir = ".", samp_names = NULL)
```

Notes:

For increased performance, a batch_size parameter can be specified. This will open multiple files at once, but keep in mind that increasing the batch_size will increase the memory needs as well.

## Potential import pitfalls

-   Too many missing CpGs, if not expected, might indicate that something went wrong.

    -   An obvious error is using the wrong reference genome.

    -   A common mistake is falsely indicating strandedness and zero or one based positioning. The combination of the two might lead to only using C-s from one strand (due to a 1 bp shift), resulting lower coverage for the sites. A nice description of the zero- and one-based coordination system can be found [here](http://genome.ucsc.edu/blog/the-ucsc-genome-browser-coordinate-counting-systems/).


